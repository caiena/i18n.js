# Releasing

## setup

- `npm install -g npm@9.1.2`
- `npm install`
- `npm run build`
- `npm run test`


## pre-testing

- `npm run build`
- `bin/console`
  - enter the node REPL and interact with `i18n`, which is available globally
  - sample: `i18n.l("currency", 1990.99)` should output `"R$ 1.990,99"` (`pt-BR` locale!)
  - sample: `i18n.l("date.formats.short", "2009-09-18")` should output `"18 de Set"` (`pt-BR` locale!)


## publishing

- edit `package.json`, bumping version
- `git commit -m "v1.2.3"`
- `git tag ${git_tag}`
- `git push upstream ${release_branch}`
- `git push upstream --tags`
- `gh release create ${git_tag} --prerelease --generate-notes`
- `npm publish --access=public`
- check on https://www.npmjs.com/settings/caiena/packages


_old yarn instructions:_
- IMPORTANT: do not edit `package.json` file, bumping `version` key, because `yarn publish` will already do that
  - it updates package.json version
  - creates a new git commit with the specified version as the message
  - creates a new git tag with the specified version as name
- run `yarn publish` (a `yarn login` is probably required)
  + it'll ask for a new version and edit package.json if you provide it
- then publish `git` _commit_ and _tag_ auto-generated by `yarn publish`
  - `git push upstream master-or-release-branch`
  - `git push upstream --tags`
